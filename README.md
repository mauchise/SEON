# SEON: S-Expression Object Notation
> 版本: Draft v0.1

SEON 是一种现代、高效、对人类和机器都极其友好的数据标记格式。我们坚信，数据表达应该回归简洁、高效和可读的本质。SEON 从 Lisp 的 S-表达式中汲取灵感，旨在成为 JSON、XML 和 YAML 等标记格式的一个更优雅、更强大的替代方案。

## 为什么选择 SEON？
在数据交换和配置文件格式的演进中，我们似乎在「机器友好」和「人类可读」之间做了太多妥协，引入了大量不必要的语法噪音。SEON 旨在打破这一现状。

- **简洁至上**: SEON 的语法核心只有括号 `()`和空格。无需逗号、冒号，也无需强制使用双引号。这使得数据本身成为焦点，而不是语法。
- **高信噪比**: 每一个字符都服务于结构或数据。相比 JSON 繁琐的 `{"key": "value"}`，SEON 的 `(key value)` 更加直接。
- **天生结构化**: 嵌套的 S-表达式天生就是一棵树。数据层次一目了然，无需猜测或依赖缩进。
- **易于解析**: SEON 的规则极其简单和一致，这使得编写解析器变得非常容易，且解析性能极高。
- **多场景适配**: SEON 完全兼容现有主流配置文件的思想，将成为配置文件、前后端通信、DSL等场景的极佳选择。

### SEON vs 主流标记格式

| 特性         | SEON                 | JSON                    | XML                    | YAML                   |
| :----------- | :------------------- | :---------------------- | :--------------------- | :--------------------- |
| **基本结构** | 对象 `{}` / S-表达式 `(key ...)` | 对象 `{}` / 数组 `[]`   | 标签 `<tag>`           | 缩进键值对             |
| **语法噪音** | 极低                 | 中等 (引号, 逗号, 括号) | 高 (尖括号, 结束标签)  | 低 (但对缩进敏感)      |
| **数据类型** | `#` 前缀显式区分     | 原生支持                | 皆为字符串 (需 Schema) | 自动推断 (易出错)      |
| **注释**     | 支持 (使用分号 `;`)  | 不支持 (需预处理)       | 支持 `<!-- -->`        | 支持 `#`               |
| **可读性**   | 极高（一旦适应）     | 良好                    | 冗长                   | 良好（但易因缩进混淆） |
| **可扩展性** | 原生支持宏和 Schema  | 需借助外部标准          | 强大 (DTD, XSD)        | 较弱                   |

## 了解 SEON
让我们通过一篇完整的博客文章（包含元数据和富文本内容）来了解 SEON 的核心语法。

```seon
; 嵌套对象由 {} 包裹。
; {} 是 (#object ...) 的语法糖。
{
  ; 格式为 (key ...values)。只有一个 value 时为标量。
  (id post-123)
  (title `SEON: A New Era for Data`)

  ; key 后面有多个 value 时，自动成为列表。
  (tags data-format lisp s-expression seon)

  ; 如果逻辑上是列表，但只有一个元素，或者列表为空，请使用 () 显式声明。
  (co-authors ({
    (id user-9527)
    (name `Alex Raymond`)
    (age #nil) ; 空值
  }))
  (empty-list ())

  (theme-color \#facccc) ; 使用 \ 进行转义
  (published #true)

  (reading-time #15.5) ; 支持浮点数
  (views #2.4e3)       ; 支持科学记数法
  (reading-stats
    (2025-01 #1200 #300)
    (2025-02 #1350 #320)
    (2025-03 #1600 #380)
  )

  (content
    (h1 `Welcome to the World of SEON`)
    
    (p 
      `SEON 是一种基于 S-表达式 的数据格式。`
      `它的目标是同时做到 ` (b `人类可读`) ` 和 ` (b `机器友好`)
      `，彻底摆脱 JSON 或 XML 的语法噪音。`
    )
    
    (h2 `核心特性`)
    
    (ul
      (li `极简的语法`)
      (li `高信噪比`)
      (li `天生结构化，易于嵌套`)
    )
    
    (p 
      `更多信息，请访问 `
      (link {(href `https://github.com/mauchise/SEON`)} `官方代码仓库`)
      `。`
    )
  )
}
```


其等效于 JSON: 
```json
{
  "id": "post-123",
  "title": "SEON: A New Era for Data",
  "tags": ["data-format", "lisp", "s-expression", "seon"],
  "co-authors": [{
    "id": "user-9527",
    "name": "Alex Raymond"
  }],
  "empty-list": [],
  "theme-color": "#facccc",
  "published": true,
  "reading-time": 15.5,
  "views": 2.4e3,
  "reading-stats": [["2025-01", 1200, 300], ["2025-02", 1350, 320], ["2025-03", 1600, 380]],
  "content": [
    ["h1", "Welcome to the World of SEON"],
    ["p",
      "SEON 是一种基于 S-表达式 的数据格式。",
      "它的目标是同时做到 ", ["b", "人类可读"], " 和 ", ["b", "机器友好"],
      "，彻底摆脱 JSON 或 XML 的语法噪音。"
    ],
    ["h2", "核心特性"],
    ["ul",
      ["li", "极简的语法"],
      ["li", "高信噪比"],
      ["li", "天生结构化，易于嵌套"]
    ],
    ["p",
      "更多信息，请访问 ",
      ["link", {"href": "https://github.com/mauchise/SEON"}, "官方代码仓库"],
      "。"
    ],
  ]
}
```

## 语法精要
SEON 的语法围绕一个核心概念构建: **万物皆为 S-表达式**。一个 S-表达式（S-expression, Symbolic Expression）就是一个由括号 () 包裹的、由空格分隔的列表。

本章节将系统地介绍构成 SEON 文档的所有核心元素。

### 1. 基本结构与注释

- **S-表达式**: SEON 文档由一个或多个 S-表达式组成。
- **分隔符**: 表达式内的元素（如键、值）由一个或多个空格、换行或制表符分隔。
- **注释**: 分号 `;` 用于单行注释。从 `;` 开始直到行尾的所有内容都会被解析器忽略。

```seon
; 这是一个注释，它将被忽略。
{ ; 对象从这里开始
  (key value) ; 这是一个键值对
}
```

### 2. 对象
对象是键值对的集合，是 SEON 中最核心的数据结构。

- **语法**: 对象由花括号 `{}` 包裹，或者使用原生表达式 `(#object ...)`。花括号是后者的语法糖，更推荐使用。
- **键值对**: 在对象内部，每个 S-表达式 `(key ...values)` 都被视为一个键值对。
  - `key` 是一个字符串或符号（见下文）。
  - `...values` 是跟随 key 的一个或多个值。

#### 值的形式
根据 key 后面值的数量，其语义会自动确定: 
- **单个值 (Scalar)**: key 后面只有一个值时，它被解析为标量。
  ```seon
  (id post-123)         ; 值是字符串 "post-123"
  (published #true)     ; 值是布尔值 true
  (author { (id u-1) }) ; 值是另一个对象
  ```

- **多个值 (List)**: `key` 后面有多个值时，它们会自动组合成一个列表。
  ```seon
  (tags data-format lisp seon) ; 值是 ["data-format", "lisp", "seon"]
  (co-authors {..} {..})       ; 值是 [ {..}, {..} ]
  ```

- **显式列表 (Explicit List)**: 如果你想表达一个**只含单个元素的列表**或**空列表**，需要用 `()` 将值包裹起来，以区别于标量。
  ```seon
  (tags (data-format)) ; 值是 ["data-format"]
  (co-authors ())       ; 值是 []
  ```

### 3. 列表 (List)

除了在对象中作为值出现，列表也可以作为一种独立的结构，常见于表示富文本内容或元组集合。在对象之外的 S-表达式 `(...)` 通常被解析为列表。

```seon
; reading-stats 的值是一个列表，其中每个元素也是一个列表
(reading-stats
  (2025-01 #1200 #300) ; 解析为 ["2025-01", 1200, 300]
  (2025-02 #1350 #320) ; 解析为 ["2025-02", 1350, 320]
)

; content 的值是一个由不同 S-表达式组成的列表
(content
  (h1 `Welcome ...`) ; 解析为 ["h1", "Welcome ..."]
  (p `SEON is ...`)  ; 解析为 ["p", "SEON is ..."]
  (ul ...)
)
```


### 4. 数据类型
SEON 支持丰富的数据类型。字符串可以直接书写，而其他显式类型则通过 `#` 前缀来标记。

#### a. 字符串
- **无引号字符串**
  - 用于键（Key）和简单的、不含空格或特殊字符的枚举值。
  - 它可以包含字母、数字和部分符号（如 `-`、`.`），但不能包含空格、`()`、`{}`、`;`、`#` 和 `\`` 等语法保留字符。
  - 示例: `id`, `post-123`, `h1`, `theme-color`

- **反引号字符串**
  - 使用反引号 `` ` `` 包裹，用于表示任意文本内容，可以包含空格和换行符。
  - 这是表达段落、标题等富文本内容的主要方式。
  - 如果字符串本身需要包含反引号，请使用 `\` 进行转义，即 `\`\``.
  - 示例: `` `SEON: A New Era for Data` ``

#### b. 类型前缀 `#`
为了避免类型推断的模糊性（如 YAML 中 `no` 可能被误认为 `false`），SEON 对非字符串的原子类型使用 `#` 前缀进行显式声明。

| 表达式 | 语义 | 对应 JSON |
| :--- | :--- | :--- |
| **数值** |
| `#123` | 整数 | `123` |
| `#-45` | 负整数 | `-45` |
| `#3.14` | 浮点数 | `3.14` |
| `#6.022e23` | 科学记数法 | `6.022e23` |
| **布尔** |
| `#true` | 布尔真 | `true` |
| `#false` | 布尔假 | `false` |
| **空值** |
| `#nil` | 空值 / null | `null` |
| **常量** |
| `#inf`, `#-inf` | 正/负无穷 | *取决于具体实现* |

### 5. 转义字符 (Escaping)
反斜杠 `\` 是 SEON 的转义字符。当你想在无引号字符串或符号中使用语法保留字符时，可以用它来消除其特殊含义。

- **场景**: 在一个无引号的值里，你想以 `#` 开头，但它又不是一个类型标记。
  ```seon
  (theme-color \#facccc) ; 解析为字符串 "#facccc"，而不是一个语法错误
  ```
- **要转义的字符**: 在需要时，`(`、`)`、`{`、`}`、`;`、`#`、`\` 以及 `` ` `` 都可以被转义。

## 未来规划
SEON 的目标远不止于成为一个更漂亮的 JSON。我们正在构建一个完整的生态系统，让数据处理变得前所未有的简单和强大。

- **原生 Schema 系统**: 通过 `#define` 和 `#list` 等宏，直接在数据文件中定义结构，实现数据的自描述和自验证。
- **类型约束**: 支持为 Schema 字段定义强类型（如 `number`, `text`, `bool`），并可设置默认值。
- **模块化与导入**: 使用 `#import` 来加载和复用外部的 Schema 定义，构建可组合、可维护的数据模型。
- **编辑器/IDE 支持**: 我们将致力于为 VS Code, JetBrains IDEs 等主流编辑器提供支持，包括: 
  - 语法高亮
  - 格式化工具
  - 基于 Schema 的自动补全和错误检查
- **官方解析器**: 提供针对主流语言（Go, Rust, Python, TypeScript/JavaScript）的高性能官方解析器库。

## 如何贡献
我们热烈欢迎所有对 SEON 感兴趣的开发者参与贡献！无论您是想改进规范、编写代码、创建工具还是撰写文档，您的帮助都至关重要。

- **讨论**: 如果您有任何想法或建议，请先在 GitHub Discussions 中发起一个讨论。
- **报告问题**: 如果您发现了 Bug 或规范中的歧义，请通过 GitHub Issues 提交。
- **贡献代码**:
  - Fork 本仓库。
  - 创建一个新的特性分支 (`git checkout -b feature/your-amazing-idea`)。
  - 提交您的更改 (`git commit -m 'Add some amazing feature'`)。
  - 将分支推送到您的 Fork (`git push origin feature/your-amazing-idea`)。
  - 创建一个 Pull Request。

## 许可
本项目采用 MIT 许可证。
